<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral analysis in Pioran · Pioran.jl</title><meta name="title" content="Spectral analysis in Pioran · Pioran.jl"/><meta property="og:title" content="Spectral analysis in Pioran · Pioran.jl"/><meta property="twitter:title" content="Spectral analysis in Pioran · Pioran.jl"/><meta name="description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><meta property="og:description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><meta property="twitter:description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Pioran.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pioran.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Basic usage</span><ul><li class="is-active"><a class="tocitem" href>Spectral analysis in Pioran</a><ul class="internal"><li><a class="tocitem" href="#Gaussian-process-regression"><span>Gaussian process regression</span></a></li><li><a class="tocitem" href="#Gaussian-processes-in-Pioran"><span>Gaussian processes in Pioran</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../modelling/">Modelling</a></li><li><a class="tocitem" href="../simulations/">Simulations</a></li><li><a class="tocitem" href="../timeseries/">Time series and priors</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics post-inference</a></li></ul></li><li><span class="tocitem">Inference</span><ul><li><a class="tocitem" href="../turing/">Hamiltonian Monte Carlo with Turing.jl</a></li><li><a class="tocitem" href="../ultranest/">Nested sampling with ultranest</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basic usage</a></li><li class="is-active"><a href>Spectral analysis in Pioran</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral analysis in Pioran</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mlefkir/Pioran.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mlefkir/Pioran.jl/blob/main/docs/src/explanation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spectral-analysis-in-Pioran"><a class="docs-heading-anchor" href="#Spectral-analysis-in-Pioran">Spectral analysis in Pioran</a><a id="Spectral-analysis-in-Pioran-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-analysis-in-Pioran" title="Permalink"></a></h1><p>Here we only give a brief introduction to Gaussian processes and how we use them in <code>Pioran</code> to infer the power spectrum of a random time series. For more details on Gaussian processes, we refer the reader to the book by Rassmusen and Williams <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><h2 id="Gaussian-process-regression"><a class="docs-heading-anchor" href="#Gaussian-process-regression">Gaussian process regression</a><a id="Gaussian-process-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-process-regression" title="Permalink"></a></h2><p>A Gaussian process <span>$\boldsymbol{f}$</span> is formally defined as a collection of random variables, any finite number of which have a joint Gaussian distribution. This process is fully described by its mean function <span>$\mu(t)$</span> and its covariance function (or kernel) <span>$k(t,t&#39;)$</span>. The kernel must be a positive-definite function, i.e. the covariance matrix <span>$K$</span> with elements <span>$K_{ij} = k(t_i, t_j)$</span> must be positive-definite. </p><h4 id="Likelihood-function"><a class="docs-heading-anchor" href="#Likelihood-function">Likelihood function</a><a id="Likelihood-function-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-function" title="Permalink"></a></h4><p>Assuming data <span>$\boldsymbol{x}(t)$</span> are generated by a Gaussian process <span>$\boldsymbol{f}$</span> with constant mean <span>$\mu$</span> and covariance function <span>$k(t,t&#39;)$</span>, a likelihood function can be derived. The log-likelihood function is given by:</p><p class="math-container">\[\ln\mathcal{L}(\boldsymbol{\theta},\nu,\mu)=-\frac{1}{2}\left( \boldsymbol{x} - \mu \right)^{\rm T} \left(K +\nu\boldsymbol{\sigma^2} I\right)^{-1} \left( \boldsymbol{x} - \mu \right) -\dfrac{1}{2}\ln\left|K +\nu\boldsymbol{\sigma^2} I\right| - \dfrac{n}{2}\ln(2\pi)\]</p><p>where <span>$\boldsymbol{\theta}$</span> are the parameters of the covariance function, <span>$\nu$</span> is a scale on the measurement variance, <span>$\mu$</span> is the mean of the process, <span>$\boldsymbol{\sigma^2}$</span> is the measurement noise, and <span>$n$</span> is the number of data points. In practice, Gaussian process regression is computationally expensive! The cost of evaluating this likelihood function scales as <span>$\mathcal{O}(n^3)$</span> and the cost of storing the covariance matrix in the memory scales as <span>$\mathcal{O}(n^2)$</span>.</p><h4 id="Conditional-Gaussian-process"><a class="docs-heading-anchor" href="#Conditional-Gaussian-process">Conditional Gaussian process</a><a id="Conditional-Gaussian-process-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-Gaussian-process" title="Permalink"></a></h4><p>The conditional distribution of the Gaussian process given the data  <span>$\boldsymbol{x}$</span> and time values <span>$\boldsymbol{t}$</span>, is also a Gaussian process. This new distribution can be used to make predictions at new points <span>$\boldsymbol{t_*}$</span> and the predictive distribution is given by</p><p class="math-container">\[\begin{aligned}
\mathbb{E}[\boldsymbol{f_*}| \boldsymbol{t},\boldsymbol{x},\boldsymbol{t_*}] &amp;= K_* \left[K +\boldsymbol{\sigma^2} I \right]^{-1} \boldsymbol{x}.\\
\mathrm{Cov}[\boldsymbol{f_*}| \boldsymbol{t},\boldsymbol{x},\boldsymbol{t_*}] &amp;= K_{**} - K_* \left[K +\boldsymbol{\sigma^2} I \right]^{-1} {K_*}^{\rm T}
\end{aligned}\]</p><p>where <span>$K_*$</span> is the covariance matrix between the new points <span>$\boldsymbol{t_*}$</span> and the old points <span>$\boldsymbol{t}$</span>, and <span>$K_{**}$</span> is the covariance matrix between the new points <span>$\boldsymbol{t_*}$</span>. The cost of computing the conditional distribution scales as <span>$\mathcal{O}(n^3)$</span>. </p><h3 id="Covariance-functions-and-power-spectral-densities"><a class="docs-heading-anchor" href="#Covariance-functions-and-power-spectral-densities">Covariance functions and power spectral densities</a><a id="Covariance-functions-and-power-spectral-densities-1"></a><a class="docs-heading-anchor-permalink" href="#Covariance-functions-and-power-spectral-densities" title="Permalink"></a></h3><p>Here we model time series data, i.e. data indexed by time. We will assume a one-dimensional and stationary Gaussian process. In this case, the covariance function <span>$k(t,t&#39;)$</span> is only a function of the time separation <span>$\tau = t - t&#39;$</span>. The covariance function and the power spectral density are Fourier pairs. </p><p class="math-container">\[\mathcal{P}(f) = \int_{-\infty}^{+\infty} k(\tau) e^{-2{\rm i}\pi f \tau} {\rm d }\tau \quad  \quad k(\tau) = \int_{-\infty}^{+\infty}  \mathcal{P}(f) e^{2{\rm i}\pi f \tau} {\rm d }f\]</p><p>If we could use the power spectral density to compute the covariance function, we could then use the covariance function to compute the likelihood function and infer the parameters of the power spectral density using Gaussian process regression. Unfortunately, it is not always easy to compute the covariance function from the power spectral density, for instance the <a href="../api/#Pioran.DoubleBendingPowerLaw"><code>DoubleBendingPowerLaw</code></a> model does not have a known Fourier transform. </p><h2 id="Gaussian-processes-in-Pioran"><a class="docs-heading-anchor" href="#Gaussian-processes-in-Pioran">Gaussian processes in Pioran</a><a id="Gaussian-processes-in-Pioran-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-processes-in-Pioran" title="Permalink"></a></h2><p>In <code>Pioran</code>, we use Gaussian processes to model the time series data and infer the parameters of the power spectral density. We implement the <a href="../api/#Pioran.ScalableGP"><code>ScalableGP</code></a> type to build a Gaussian process using the <a href="https://github.com/JuliaGaussianProcesses/AbstractGPs.jl">AbstractGPs</a> interface. </p><p>As presented above, Gaussian process regression is expensive to compute and it is not possible to describe all possible spectral densities with analytical kernels. Here we propose to use an approximation of the power spectral density by a sum of simple power spectral densities. We choose these simple power spectral densities to be the Fourier transform of known covariance functions which have a quasi-separable structure. This enables the fast and scalable computation of the log-likelihood function using the <code>celerite</code> algorithm introduced by Foreman-Mackey et al.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. Python implementations of the <code>celerite</code> algorithm are available in <a href="https://celerite2.readthedocs.io/en/latest/">celerite2</a> and <a href="https://tinygp.readthedocs.io/en/stable/">tinygp</a>.</p><p>This method uses the quasi-separable structure of the covariance functions <a href="../api/#Pioran.Celerite"><code>Celerite</code></a>, <a href="../api/#Pioran.SHO"><code>SHO</code></a> and <a href="../api/#Pioran.Exp"><code>Exp</code></a> to compute the log-likelihood in a linear scaling with the number of datapoints as shown in the following benchmarks.</p><p><img src="../figures/Likelihood_benchmarks_bis.png" alt="benchmark_likelihood"/></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Rassmusen, C. E., &amp; Williams, C. K. I. (2006). Gaussian Processes for Machine Learning. MIT Press.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Foreman-Mackey D., Agol E., Ambikasaran S., Angus R., 2017, AJ, <a href="https://ui.adsabs.harvard.edu/abs/2017AJ....154..220F/abstract">154, 220</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../modelling/">Modelling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 6 March 2024 10:22">Wednesday 6 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
