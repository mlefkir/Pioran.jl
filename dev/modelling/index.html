<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Modelling · Pioran.jl</title><meta name="title" content="Modelling · Pioran.jl"/><meta property="og:title" content="Modelling · Pioran.jl"/><meta property="twitter:title" content="Modelling · Pioran.jl"/><meta name="description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><meta property="og:description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><meta property="twitter:description" content="Pioran.jl: A Julia package for power spectral density estimation using scalable Gaussian processes."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Pioran.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pioran.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Basic usage</span><ul><li><a class="tocitem" href="../explanation/">Spectral analysis in Pioran</a></li><li class="is-active"><a class="tocitem" href>Modelling</a><ul class="internal"><li><a class="tocitem" href="#Modelling-the-power-spectral-density"><span>Modelling the power spectral density</span></a></li><li><a class="tocitem" href="#Approximating-the-power-spectral-density"><span>Approximating the power spectral density</span></a></li><li><a class="tocitem" href="#Building-the-Gaussian-process"><span>Building the Gaussian process</span></a></li></ul></li><li><a class="tocitem" href="../simulations/">Simulations</a></li><li><a class="tocitem" href="../timeseries/">Time series and priors</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics post-inference</a></li></ul></li><li><span class="tocitem">Inference</span><ul><li><a class="tocitem" href="../turing/">Hamiltonian Monte Carlo with Turing.jl</a></li><li><a class="tocitem" href="../ultranest/">Nested sampling with ultranest</a></li></ul></li><li><a class="tocitem" href="../carma/">CARMA</a></li><li><a class="tocitem" href="../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basic usage</a></li><li class="is-active"><a href>Modelling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Modelling</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mlefkir/Pioran.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mlefkir/Pioran.jl/blob/main/docs/src/modelling.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Modelling"><a class="docs-heading-anchor" href="#Modelling">Modelling</a><a id="Modelling-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling" title="Permalink"></a></h1><h2 id="Modelling-the-power-spectral-density"><a class="docs-heading-anchor" href="#Modelling-the-power-spectral-density">Modelling the power spectral density</a><a id="Modelling-the-power-spectral-density-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-the-power-spectral-density" title="Permalink"></a></h2><p>We use <a href="../api/#Pioran.SingleBendingPowerLaw"><code>SingleBendingPowerLaw</code></a> and <a href="../api/#Pioran.DoubleBendingPowerLaw"><code>DoubleBendingPowerLaw</code></a> to model the power spectral density of the random process generating the time series data.</p><pre><code class="language-julia hljs">using Plots
using Pioran
𝓟1 = SingleBendingPowerLaw(1., .1, 3.4)
𝓟2 = SingleBendingPowerLaw(.4, 1e-2, 3.)
𝓟3 = SingleBendingPowerLaw(.1, 3., 2.4)
𝓟1d = DoubleBendingPowerLaw(1.2,1e-3,2.4,1.1,4.2)
𝓟2d = DoubleBendingPowerLaw(0.2,1e-2,1.3,24.3,3.1)
𝓟3d = DoubleBendingPowerLaw(0.5,1e-3,2.1,91.2,4.9)
f = 10 .^ range(-4, stop=3, length=1000)
l = @layout [a b]
p1 =  plot(f,[𝓟1(f),𝓟2(f),𝓟3(f)],xlabel=&quot;Frequency (day^-1)&quot;,ylabel=&quot;Power Spectral Density&quot;,legend=false,framestyle = :box,xscale=:log10,yscale=:log10,ylims=(1e-15,1e1),lw=2)
p2 =  plot(f,[𝓟1d(f),𝓟2d(f),𝓟3d(f)],xlabel=&quot;Frequency (day^-1)&quot;,legend=false,framestyle = :box,xscale=:log10,yscale=:log10,ylims=(1e-15,1e1),lw=2)
plot(p1,p2,layout=l,size=(700,300),grid=false,left_margin=2Plots.mm,bottom_margin=20Plots.px,title=[&quot;Single bending power-law&quot; &quot;Double bending power-law&quot;])</code></pre><img src="cb83da28.svg" alt="Example block output"/><h2 id="Approximating-the-power-spectral-density"><a class="docs-heading-anchor" href="#Approximating-the-power-spectral-density">Approximating the power spectral density</a><a id="Approximating-the-power-spectral-density-1"></a><a class="docs-heading-anchor-permalink" href="#Approximating-the-power-spectral-density" title="Permalink"></a></h2><p>To obtain the covariance function, we approximate the power spectral density by a sum of basis functions <span>$\psi(f)$</span>. At the moment, we use either of the following basis functions:</p><p class="math-container">\[\begin{align}\begin{split}
\psi_4(f) = \frac{1}{1+f^4}\\
\psi_6(f) = \frac{1}{1+f^6}
\end{split}
\end{align}\]</p><p>These basis functions have analytical Fourier transforms and are used to approximate the covariance function. The Fourier transform of the basis functions are given by</p><p class="math-container">\[\begin{align}\begin{split}
\phi_4(\tau) &amp;= \exp\left(-\pi\sqrt{2}\tau\right) \left(\cos\left(\pi\sqrt{2}\tau\right)+\sin\left(\pi\sqrt{2}\tau\right)\right)\\
\phi_6(\tau) &amp;=\pi/3\exp{\left(-2\pi \tau\right)}+\exp{\left(-\pi\tau\right)}\left(\pi/3\cos\left(\pi\sqrt{3}\tau\right)+\pi/\sqrt{3}\sin\left(\pi\sqrt{3}\tau\right)\right)\end{split}
\end{align}\]</p><p>We need to specify the frequency range <code>f0</code> and <code>fM</code> over which the approximation is performed. We also need to specify the number of basis functions <code>J</code> to use. Once this is done the frequency grid is defined as:</p><p class="math-container">\[f_j=f_\mathrm{start}\left({f_\mathrm{stop}}/{f_\mathrm{start}}\right)^{j/(J-1)}\]</p><p>The approximation of the power spectral density is then given by</p><p class="math-container">\[\begin{align}
    \mathcal{P}(f)\simeq \tilde{\mathcal{P}}(f)&amp;=  \sum\limits_{j=0}^{J-1} a_j \psi(f/f_j)\\
    \mathcal{R}(\tau)\simeq \tilde{\mathcal{R}}(\tau)&amp;= \sum\limits_{j=0}^{J-1} a_j f_j \phi(\tau f_j)
\end{align}\]</p><p>Adding the constraint that the approximation and the true power spectrum must be equal on the grid of frequencies gives a linear system of <span>$J$</span> equations for the coefficients <span>$a_j$</span>. This system can be written with a Toeplitz matrix <span>$B$</span>  and a vector <span>$\boldsymbol{a}$</span> as:</p><p class="math-container">\[\begin{align}
\boldsymbol{p} = \boldsymbol{a} B \quad \text{where } B_{ij}=\psi(f_i/f_j) \text{ and } p_j = \mathcal{P}(f_j)
\end{align}\]</p><p>The values of <span>$p_j$</span>&quot; are divided by <span>$p_0$</span> so that the values of <span>$a_j$</span> are not too high, what we are interested in is the amplitude of the covariance function which gives the variance of the process - the integral of the power spectrum.</p><p>Visually, the approximation can be seen as follows:</p><pre><code class="language-julia hljs">f0, fM = 1e-3, 1e3
𝓟 = SingleBendingPowerLaw(.4, 1e-1, 3.)
f = 10 .^ range(-3, stop=3, length=1000)
psd_approx = Pioran.approximated_psd(f, 𝓟, f0, fM, n_components=20,basis_function=&quot;SHO&quot;,individual=true)

plot(f,𝓟(f)/𝓟(f0),xscale=:log10,yscale=:log10,label=&quot;True PSD&quot;,xlabel=&quot;Frequency (day^-1)&quot;,ylabel=&quot;Power Spectral Density&quot;,lw=2,framestyle = :box,grid=false)
plot!(f,sum(psd_approx,dims=2),label=&quot;Approximated PSD&quot;,lw=2)
plot!(f,psd_approx,label=nothing,color=:black,alpha=.5,ylims=(1e-15,1e1),ls=:dot)</code></pre><img src="15f87dd8.svg" alt="Example block output"/><h3 id="Limitations-and-diagnostics-for-the-approximation"><a class="docs-heading-anchor" href="#Limitations-and-diagnostics-for-the-approximation">Limitations and diagnostics for the approximation</a><a id="Limitations-and-diagnostics-for-the-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations-and-diagnostics-for-the-approximation" title="Permalink"></a></h3><div class="admonition is-warning"><header class="admonition-header">Limitations of the approximation</header><div class="admonition-body"><p>This approximation is limited by the steepness of the basis functions, this means that if the power spectrum you want to approximate is steeper than the basis functions, the approximation may fail. Equivalently, the basis functions are flat at low frequencies, modelling a rising power spectrum at low frequencies can also be difficult.</p></div></div><p>In order to check the quality of the approximation, we can compute the residuals and ratios between the true and approximated power spectrum. First, we need to define the range of allowed values for each parameter to check. As we adopt a Bayesian workflow, one can use the prior distribution to define the range of allowed values for each parameter. This can be done as follows:</p><pre><code class="language-julia hljs">using Distributions
using Random
rng = MersenneTwister(1234)

min_f_b, max_f_b = 1e-3, 1e3
function prior_transform(cube)
    α₁ = quantile(Uniform(0.0, 1.25), cube[1])
    f₁ = quantile(LogUniform(min_f_b, max_f_b), cube[2])
    α₂ = quantile(Uniform(α₁, 4.0), cube[3])
    variance = quantile(LogNormal(-1,2), cube[4])
    return [α₁, f₁, α₂, variance]
end

P = 2000
unif = rand(rng, 4, P)
priors = mapreduce(permutedims, hcat, [prior_transform(unif[:, i]) for i in 1:P]&#39;)
l = @layout [a b ; c d]
p1 = histogram(priors[1,:],xlabel=&quot;α₁&quot;)
bins = 10.0 .^LinRange( log10(minimum(priors[2,:])),log10(quantile(priors[2,:],.99)),30)
p2 = histogram(priors[2,:],bins=bins,xaxis=(:log10,(bins[1],bins[end])),xlabel=&quot;f₁&quot;)
p3 = histogram(priors[3,:],xlabel=&quot;α₂&quot;)
bins = 10.0 .^LinRange( log10(minimum(priors[4,:])),log10(quantile(priors[4,:],1)),30)
p4 = histogram(priors[4,:],xlabel=&quot;variance&quot;,bins=bins,xaxis=(:log10,(bins[1],bins[end])))
plot(p1,p2,p3,p4,layout=l,size=(700,300),grid=false,left_margin=2Plots.mm,bottom_margin=20Plots.px,legend=false)</code></pre><img src="b50d6ccb.svg" alt="Example block output"/><p>We can then use the function <a href="../api/#Pioran.run_diagnostics-NTuple{7, Any}"><code>run_diagnostics</code></a> to assess the quality of the approximation.  The first argument is an array containing the parameters of the power spectral density, the second argument is the variance of the process. <code>f_min</code> and <code>f_max</code> are the minimum and maximum frequencies of the time series, this is to show the window of observed frequencies in the plots.</p><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.activate!(type = &quot;png&quot;)
f_min, f_max = 1e-3 * 5, 1e3 / 5
figs = run_diagnostics(priors[1:3, :], priors[4, :], f0, fM, SingleBendingPowerLaw, f_min,f_max, n_components=20, basis_function=&quot;SHO&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Makie.Figure}:
 Figure()
 Figure()
 Figure()</code></pre><p>The following plots are produced: The mean of the residuals and ratios as a function of frequency.</p><img src="a746fabe.png" alt="Example block output"/><p>The quantiles of the residuals and ratios as a function of frequency. </p><img src="b5c5f265.png" alt="Example block output"/><p>The distribution of the mean, median and maximum values of the frequency-averaged residuals and ratios.</p><img src="54937ce0.png" alt="Example block output"/><p>Using these three diagnostics we can see that a <code>SingleBendingPowerLaw</code> with the chosen prior distributions can be well approximated with 20 SHO basis functions.</p><h2 id="Building-the-Gaussian-process"><a class="docs-heading-anchor" href="#Building-the-Gaussian-process">Building the Gaussian process</a><a id="Building-the-Gaussian-process-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-Gaussian-process" title="Permalink"></a></h2><p>Now that we have checked that approximation hold for our choice of priors we can build the Gaussian process.</p><h3 id="Building-the-covariance-function"><a class="docs-heading-anchor" href="#Building-the-covariance-function">Building the covariance function</a><a id="Building-the-covariance-function-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-covariance-function" title="Permalink"></a></h3><p>The covariance function using the approximation of the power spectral density is obtained using the function <a href="../api/#Pioran.approx"><code>approx</code></a>. We need to specify the frequency range <code>f0</code> and <code>fM</code> over which the approximation is performed, the number of basis functions <code>J</code> to use, and the variance of the process - integral of the power spectrum. One can also give the type of basis function to use, the default is <code>SHO</code> which corresponds to the basis function <span>$\psi_4$</span>, <code>DRWCelerite</code> corresponds to <span>$\psi_6$</span>.</p><pre><code class="language-julia hljs">𝓟 = SingleBendingPowerLaw(.4, 1e-1, 3.)

variance = 2.2
𝓡 = approx(𝓟, f0, fM, 20, variance, basis_function=&quot;SHO&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Pioran.SumOfSemiSeparable{Vector{SHO}}(SHO[SHO(0.030322884084373655, 0.006283185307179587, 0.7071067811865475), SHO(0.03429389994791425, 0.01300077798978621, 0.7071067811865475), SHO(0.06636972847744523, 0.026900404822785624, 0.7071067811865475), SHO(0.07719531985729854, 0.05566065201622968, 0.7071067811865475), SHO(0.17751466762713336, 0.11516957470645954, 0.7071067811865475), SHO(0.21627779258745894, 0.23830175281093008, 0.7071067811865475), SHO(0.9843646300036841, 0.49307923153749883, 0.7071067811865475), SHO(0.5112341247119052, 1.0202490149810555, 0.7071067811865475), SHO(0.07747022163556128, 2.111036089117155, 0.7071067811865475), SHO(0.01938464540109837, 4.36802516259994, 0.7071067811865475), SHO(0.004246466642079087, 9.038047203203158, 0.7071067811865475), SHO(0.0010188893176592427, 18.700967647060686, 0.7071067811865475), SHO(0.0002347661005093104, 38.69488431222888, 0.7071067811865475), SHO(5.519225616520317e-5, 80.06505867476409, 0.7071067811865475), SHO(1.2850746501276161e-5, 165.6656618706443, 0.7071067811865475), SHO(3.0063038738625077e-6, 342.78512970963675, 0.7071067811865475), SHO(7.013475482744144e-7, 709.2697655220816, 0.7071067811865475), SHO(1.6454614039358522e-7, 1467.5770816250977, 0.7071067811865475), SHO(3.703941006001531e-8, 3036.619626561795, 0.7071067811865475), SHO(1.1366240534046279e-8, 6283.185307179586, 0.7071067811865475)], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366])</code></pre><h3 id="Building-the-Gaussian-process-2"><a class="docs-heading-anchor" href="#Building-the-Gaussian-process-2">Building the Gaussian process</a><a class="docs-heading-anchor-permalink" href="#Building-the-Gaussian-process-2" title="Permalink"></a></h3><p>The Gaussian process is built using the type <a href="../api/#Pioran.ScalableGP"><code>ScalableGP</code></a>. If the mean of the process <span>$\mu$</span> is known, it can be given as a first argument. Otherwise, the mean is assumed to be zero.</p><pre><code class="language-julia hljs">μ = 1.3
f = ScalableGP(μ, 𝓡)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ScalableGP{AbstractGPs.GP{AbstractGPs.ConstMean{Float64}, Pioran.SumOfSemiSeparable{Vector{SHO}}}, Pioran.SumOfSemiSeparable{Vector{SHO}}}(AbstractGPs.GP{AbstractGPs.ConstMean{Float64}, Pioran.SumOfSemiSeparable{Vector{SHO}}}(AbstractGPs.ConstMean{Float64}(1.3), Pioran.SumOfSemiSeparable{Vector{SHO}}(SHO[SHO(0.030322884084373655, 0.006283185307179587, 0.7071067811865475), SHO(0.03429389994791425, 0.01300077798978621, 0.7071067811865475), SHO(0.06636972847744523, 0.026900404822785624, 0.7071067811865475), SHO(0.07719531985729854, 0.05566065201622968, 0.7071067811865475), SHO(0.17751466762713336, 0.11516957470645954, 0.7071067811865475), SHO(0.21627779258745894, 0.23830175281093008, 0.7071067811865475), SHO(0.9843646300036841, 0.49307923153749883, 0.7071067811865475), SHO(0.5112341247119052, 1.0202490149810555, 0.7071067811865475), SHO(0.07747022163556128, 2.111036089117155, 0.7071067811865475), SHO(0.01938464540109837, 4.36802516259994, 0.7071067811865475), SHO(0.004246466642079087, 9.038047203203158, 0.7071067811865475), SHO(0.0010188893176592427, 18.700967647060686, 0.7071067811865475), SHO(0.0002347661005093104, 38.69488431222888, 0.7071067811865475), SHO(5.519225616520317e-5, 80.06505867476409, 0.7071067811865475), SHO(1.2850746501276161e-5, 165.6656618706443, 0.7071067811865475), SHO(3.0063038738625077e-6, 342.78512970963675, 0.7071067811865475), SHO(7.013475482744144e-7, 709.2697655220816, 0.7071067811865475), SHO(1.6454614039358522e-7, 1467.5770816250977, 0.7071067811865475), SHO(3.703941006001531e-8, 3036.619626561795, 0.7071067811865475), SHO(1.1366240534046279e-8, 6283.185307179586, 0.7071067811865475)], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366])), Pioran.SumOfSemiSeparable{Vector{SHO}}(SHO[SHO(0.030322884084373655, 0.006283185307179587, 0.7071067811865475), SHO(0.03429389994791425, 0.01300077798978621, 0.7071067811865475), SHO(0.06636972847744523, 0.026900404822785624, 0.7071067811865475), SHO(0.07719531985729854, 0.05566065201622968, 0.7071067811865475), SHO(0.17751466762713336, 0.11516957470645954, 0.7071067811865475), SHO(0.21627779258745894, 0.23830175281093008, 0.7071067811865475), SHO(0.9843646300036841, 0.49307923153749883, 0.7071067811865475), SHO(0.5112341247119052, 1.0202490149810555, 0.7071067811865475), SHO(0.07747022163556128, 2.111036089117155, 0.7071067811865475), SHO(0.01938464540109837, 4.36802516259994, 0.7071067811865475), SHO(0.004246466642079087, 9.038047203203158, 0.7071067811865475), SHO(0.0010188893176592427, 18.700967647060686, 0.7071067811865475), SHO(0.0002347661005093104, 38.69488431222888, 0.7071067811865475), SHO(5.519225616520317e-5, 80.06505867476409, 0.7071067811865475), SHO(1.2850746501276161e-5, 165.6656618706443, 0.7071067811865475), SHO(3.0063038738625077e-6, 342.78512970963675, 0.7071067811865475), SHO(7.013475482744144e-7, 709.2697655220816, 0.7071067811865475), SHO(1.6454614039358522e-7, 1467.5770816250977, 0.7071067811865475), SHO(3.703941006001531e-8, 3036.619626561795, 0.7071067811865475), SHO(1.1366240534046279e-8, 6283.185307179586, 0.7071067811865475)], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366]))</code></pre><p>At the moment, the GP does not include the measurement variance <code>σ²</code> and the time values <code>t</code>. This is done in the next step.</p><pre><code class="language-julia hljs">σ² = yerr .^ 2
fx = f(t, σ²)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AbstractGPs.FiniteGP{ScalableGP{AbstractGPs.GP{AbstractGPs.ConstMean{Float64}, Pioran.SumOfSemiSeparable{Vector{SHO}}}, Pioran.SumOfSemiSeparable{Vector{SHO}}}, Vector{Float64}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}(
f: ScalableGP{AbstractGPs.GP{AbstractGPs.ConstMean{Float64}, Pioran.SumOfSemiSeparable{Vector{SHO}}}, Pioran.SumOfSemiSeparable{Vector{SHO}}}(AbstractGPs.GP{AbstractGPs.ConstMean{Float64}, Pioran.SumOfSemiSeparable{Vector{SHO}}}(AbstractGPs.ConstMean{Float64}(1.3), Pioran.SumOfSemiSeparable{Vector{SHO}}(SHO[SHO(0.030322884084373655, 0.006283185307179587, 0.7071067811865475), SHO(0.03429389994791425, 0.01300077798978621, 0.7071067811865475), SHO(0.06636972847744523, 0.026900404822785624, 0.7071067811865475), SHO(0.07719531985729854, 0.05566065201622968, 0.7071067811865475), SHO(0.17751466762713336, 0.11516957470645954, 0.7071067811865475), SHO(0.21627779258745894, 0.23830175281093008, 0.7071067811865475), SHO(0.9843646300036841, 0.49307923153749883, 0.7071067811865475), SHO(0.5112341247119052, 1.0202490149810555, 0.7071067811865475), SHO(0.07747022163556128, 2.111036089117155, 0.7071067811865475), SHO(0.01938464540109837, 4.36802516259994, 0.7071067811865475), SHO(0.004246466642079087, 9.038047203203158, 0.7071067811865475), SHO(0.0010188893176592427, 18.700967647060686, 0.7071067811865475), SHO(0.0002347661005093104, 38.69488431222888, 0.7071067811865475), SHO(5.519225616520317e-5, 80.06505867476409, 0.7071067811865475), SHO(1.2850746501276161e-5, 165.6656618706443, 0.7071067811865475), SHO(3.0063038738625077e-6, 342.78512970963675, 0.7071067811865475), SHO(7.013475482744144e-7, 709.2697655220816, 0.7071067811865475), SHO(1.6454614039358522e-7, 1467.5770816250977, 0.7071067811865475), SHO(3.703941006001531e-8, 3036.619626561795, 0.7071067811865475), SHO(1.1366240534046279e-8, 6283.185307179586, 0.7071067811865475)], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366])), Pioran.SumOfSemiSeparable{Vector{SHO}}(SHO[SHO(0.030322884084373655, 0.006283185307179587, 0.7071067811865475), SHO(0.03429389994791425, 0.01300077798978621, 0.7071067811865475), SHO(0.06636972847744523, 0.026900404822785624, 0.7071067811865475), SHO(0.07719531985729854, 0.05566065201622968, 0.7071067811865475), SHO(0.17751466762713336, 0.11516957470645954, 0.7071067811865475), SHO(0.21627779258745894, 0.23830175281093008, 0.7071067811865475), SHO(0.9843646300036841, 0.49307923153749883, 0.7071067811865475), SHO(0.5112341247119052, 1.0202490149810555, 0.7071067811865475), SHO(0.07747022163556128, 2.111036089117155, 0.7071067811865475), SHO(0.01938464540109837, 4.36802516259994, 0.7071067811865475), SHO(0.004246466642079087, 9.038047203203158, 0.7071067811865475), SHO(0.0010188893176592427, 18.700967647060686, 0.7071067811865475), SHO(0.0002347661005093104, 38.69488431222888, 0.7071067811865475), SHO(5.519225616520317e-5, 80.06505867476409, 0.7071067811865475), SHO(1.2850746501276161e-5, 165.6656618706443, 0.7071067811865475), SHO(3.0063038738625077e-6, 342.78512970963675, 0.7071067811865475), SHO(7.013475482744144e-7, 709.2697655220816, 0.7071067811865475), SHO(1.6454614039358522e-7, 1467.5770816250977, 0.7071067811865475), SHO(3.703941006001531e-8, 3036.619626561795, 0.7071067811865475), SHO(1.1366240534046279e-8, 6283.185307179586, 0.7071067811865475)], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.030322884084373655, 0.03429389994791425, 0.06636972847744523, 0.07719531985729854, 0.17751466762713336, 0.21627779258745894, 0.9843646300036841, 0.5112341247119052, 0.07747022163556128, 0.01938464540109837, 0.004246466642079087, 0.0010188893176592427, 0.0002347661005093104, 5.519225616520317e-5, 1.2850746501276161e-5, 3.0063038738625077e-6, 7.013475482744144e-7, 1.6454614039358522e-7, 3.703941006001531e-8, 1.1366240534046279e-8], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366], [0.0044428829381583665, 0.00919293827727864, 0.019021458666855024, 0.03935802448594069, 0.08143718726130823, 0.16850478538124908, 0.34865966828241723, 0.7214249969919999, 1.4927279339442692, 3.0886602128678895, 6.390864466069064, 13.223581037986847, 27.361415094406, 56.6145459250245, 117.14331291849025, 242.38568970759445, 501.52946089125646, 1037.73370633107, 2147.214329826007, 4442.882938158366]))
x: [0.0, 5.5, 7.25, 7.5, 7.75, 10.25, 10.5, 13.5, 16.5, 20.0  …  721.0, 721.25, 724.0, 725.0, 725.25, 725.75, 726.75, 727.75, 728.5, 729.5]
Σy: [0.0007769427202587575 0.0 … 0.0 0.0; 0.0 0.0008096922961612274 … 0.0 0.0; … ; 0.0 0.0 … 0.0007682230802508954 0.0; 0.0 0.0 … 0.0 0.0006084949733623623]
)
</code></pre><p>The log-likelihood of the Gaussian process given the data <code>y</code> can be computed using the function <code>logpdf</code> from the <code>Distributions</code> package.</p><pre><code class="language-julia hljs">logpdf(fx, y)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-243.24825422512637</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../explanation/">« Spectral analysis in Pioran</a><a class="docs-footer-nextpage" href="../simulations/">Simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 28 November 2024 18:14">Thursday 28 November 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
